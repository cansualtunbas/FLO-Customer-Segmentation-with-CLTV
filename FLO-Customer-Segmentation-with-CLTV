{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "13368b4b",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-09-10T19:12:51.331336Z",
     "iopub.status.busy": "2024-09-10T19:12:51.330877Z",
     "iopub.status.idle": "2024-09-10T19:13:14.317794Z",
     "shell.execute_reply": "2024-09-10T19:13:14.314939Z"
    },
    "papermill": {
     "duration": 23.003755,
     "end_time": "2024-09-10T19:13:14.323156",
     "exception": false,
     "start_time": "2024-09-10T19:12:51.319401",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting lifetimes\r\n",
      "  Downloading Lifetimes-0.11.3-py3-none-any.whl.metadata (4.8 kB)\r\n",
      "Requirement already satisfied: numpy>=1.10.0 in /opt/conda/lib/python3.10/site-packages (from lifetimes) (1.26.4)\r\n",
      "Requirement already satisfied: scipy>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from lifetimes) (1.14.0)\r\n",
      "Requirement already satisfied: pandas>=0.24.0 in /opt/conda/lib/python3.10/site-packages (from lifetimes) (2.2.2)\r\n",
      "Collecting autograd>=1.2.0 (from lifetimes)\r\n",
      "  Downloading autograd-1.7.0-py3-none-any.whl.metadata (7.5 kB)\r\n",
      "Requirement already satisfied: dill>=0.2.6 in /opt/conda/lib/python3.10/site-packages (from lifetimes) (0.3.8)\r\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas>=0.24.0->lifetimes) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=0.24.0->lifetimes) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=0.24.0->lifetimes) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas>=0.24.0->lifetimes) (1.16.0)\r\n",
      "Downloading Lifetimes-0.11.3-py3-none-any.whl (584 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m584.2/584.2 kB\u001b[0m \u001b[31m10.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading autograd-1.7.0-py3-none-any.whl (52 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m52.5/52.5 kB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: autograd, lifetimes\r\n",
      "Successfully installed autograd-1.7.0 lifetimes-0.11.3\r\n"
     ]
    }
   ],
   "source": [
    "###############################################################\n",
    "# Veri Seti Hikayesi\n",
    "###############################################################\n",
    "#Veri setiFlo’danson alışverişlerini2020 -2021 yıllarındaOmniChannel(hem online hem offline alışveriş yapan olarak yapan müşterilerin geçmiş alışveriş davranışlarından elde edilen bilgilerden oluşmaktadır.\n",
    "\n",
    "# master_id: Eşsiz müşteri numarası\n",
    "# order_channel : Alışveriş yapılan platforma ait hangi kanalın kullanıldığı (Android, ios, Desktop, Mobile, Offline)\n",
    "# last_order_channel : En son alışverişin yapıldığı kanal\n",
    "# first_order_date : Müşterinin yaptığı ilk alışveriş tarihi\n",
    "# last_order_date : Müşterinin yaptığı son alışveriş tarihi\n",
    "# last_order_date_online : Muşterinin online platformda yaptığı son alışveriş tarihi\n",
    "# last_order_date_offline : Muşterinin offline platformda yaptığı son alışveriş tarihi\n",
    "# order_num_total_ever_online : Müşterinin online platformda yaptığı toplam alışveriş sayısı\n",
    "# order_num_total_ever_offline : Müşterinin offline'da yaptığı toplam alışveriş sayısı\n",
    "# customer_value_total_ever_offline : Müşterinin offline alışverişlerinde ödediği toplam ücret\n",
    "# customer_value_total_ever_online : Müşterinin online alışverişlerinde ödediği toplam ücret\n",
    "# interested_in_categories_12 : Müşterinin son 12 ayda alışveriş yaptığı kategorilerin listesi\n",
    "#store_type :  3 farklıcompanyi ifade eder. A company'sinden alışveriş yapan kişi B'dende yaptı ise A,B şeklinde yazılmıştır.\n",
    "!pip install lifetimes\n",
    "import datetime as dt\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "from lifetimes import BetaGeoFitter\n",
    "from lifetimes import GammaGammaFitter\n",
    "from lifetimes.plotting import plot_period_transactions\n",
    "pd.set_option('display.max_columns', None)\n",
    "pd.set_option('display.width', 500)\n",
    "pd.set_option('display.float_format', lambda x: '%.4f' % x)\n",
    "from sklearn.preprocessing import MinMaxScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2478efa1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.344274Z",
     "iopub.status.busy": "2024-09-10T19:13:14.343414Z",
     "iopub.status.idle": "2024-09-10T19:13:14.491614Z",
     "shell.execute_reply": "2024-09-10T19:13:14.489777Z"
    },
    "papermill": {
     "duration": 0.164445,
     "end_time": "2024-09-10T19:13:14.496796",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.332351",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Görev 1:  Veriyi Hazırlama\n",
    "# Adım1:   flo_data_20K.csv verisini okuyunuz. \n",
    "df_=pd.read_csv(\"/kaggle/input/flo-data-20k/flo_data_20k.csv\")\n",
    "df = df_.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5712315c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.524716Z",
     "iopub.status.busy": "2024-09-10T19:13:14.523882Z",
     "iopub.status.idle": "2024-09-10T19:13:14.537512Z",
     "shell.execute_reply": "2024-09-10T19:13:14.535774Z"
    },
    "papermill": {
     "duration": 0.033044,
     "end_time": "2024-09-10T19:13:14.541592",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.508548",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Adım2:  Aykırı değerleri baskılamak için gerekli olan outlier_thresholds ve replace_with_thresholds fonksiyonlarını tanımlayınız. Not: cltv hesaplanırken frequency değerleri integer olması gerekmektedir.Bu nedenle alt ve üst limitlerini round() ile yuvarlayınız\n",
    "\n",
    "def outlier_thresholds(dataframe, variable):\n",
    "    quartile1 = dataframe[variable].quantile(0.01)\n",
    "    quartile3 = dataframe[variable].quantile(0.99)\n",
    "    interquantile_range = quartile3 - quartile1\n",
    "    up_limit = quartile3 + 1.5 * interquantile_range\n",
    "    low_limit = quartile1 - 1.5 * interquantile_range\n",
    "    return low_limit, up_limit\n",
    "\n",
    "#aykırı değer\n",
    "def replace_with_thresholds(dataframe, variable):\n",
    "    low_limit, up_limit = outlier_thresholds(dataframe, variable)\n",
    "    dataframe.loc[(dataframe[variable] < low_limit), variable] = low_limit\n",
    "    dataframe.loc[(dataframe[variable] > up_limit), variable] = up_limit\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "873e1f7b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.567321Z",
     "iopub.status.busy": "2024-09-10T19:13:14.566714Z",
     "iopub.status.idle": "2024-09-10T19:13:14.638288Z",
     "shell.execute_reply": "2024-09-10T19:13:14.636581Z"
    },
    "papermill": {
     "duration": 0.086304,
     "end_time": "2024-09-10T19:13:14.641606",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.555302",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>order_num_total_ever_online</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>3.1109</td>\n",
       "      <td>4.2256</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>2.0000</td>\n",
       "      <td>4.0000</td>\n",
       "      <td>200.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>order_num_total_ever_offline</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>1.9139</td>\n",
       "      <td>2.0629</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>2.0000</td>\n",
       "      <td>109.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>customer_value_total_ever_offline</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>253.9226</td>\n",
       "      <td>301.5329</td>\n",
       "      <td>10.0000</td>\n",
       "      <td>99.9900</td>\n",
       "      <td>179.9800</td>\n",
       "      <td>319.9700</td>\n",
       "      <td>18119.1400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>customer_value_total_ever_online</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>497.3217</td>\n",
       "      <td>832.6019</td>\n",
       "      <td>12.9900</td>\n",
       "      <td>149.9800</td>\n",
       "      <td>286.4600</td>\n",
       "      <td>578.4400</td>\n",
       "      <td>45220.1300</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                       count     mean      std     min      25%      50%      75%        max\n",
       "order_num_total_ever_online       19945.0000   3.1109   4.2256  1.0000   1.0000   2.0000   4.0000   200.0000\n",
       "order_num_total_ever_offline      19945.0000   1.9139   2.0629  1.0000   1.0000   1.0000   2.0000   109.0000\n",
       "customer_value_total_ever_offline 19945.0000 253.9226 301.5329 10.0000  99.9900 179.9800 319.9700 18119.1400\n",
       "customer_value_total_ever_online  19945.0000 497.3217 832.6019 12.9900 149.9800 286.4600 578.4400 45220.1300"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Adım3:  \"order_num_total_ever_online\", \"order_num_total_ever_offline\", \"customer_value_total_ever_offline\",  \"customer_value_total_ever_online\" değişkenlerinin aykırı değerleri varsa baskılayanız.\n",
    "data=[\"order_num_total_ever_online\",\"order_num_total_ever_offline\",\"customer_value_total_ever_offline\",\"customer_value_total_ever_online\"]\n",
    "df[data].describe().T\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "914819d3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.660164Z",
     "iopub.status.busy": "2024-09-10T19:13:14.659654Z",
     "iopub.status.idle": "2024-09-10T19:13:14.712976Z",
     "shell.execute_reply": "2024-09-10T19:13:14.711610Z"
    },
    "papermill": {
     "duration": 0.066595,
     "end_time": "2024-09-10T19:13:14.716502",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.649907",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>order_num_total_ever_online</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>3.0923</td>\n",
       "      <td>3.8137</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>2.0000</td>\n",
       "      <td>4.0000</td>\n",
       "      <td>48.5000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>order_num_total_ever_offline</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>1.8862</td>\n",
       "      <td>1.4347</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>2.0000</td>\n",
       "      <td>16.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>customer_value_total_ever_offline</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>251.9212</td>\n",
       "      <td>251.0226</td>\n",
       "      <td>10.0000</td>\n",
       "      <td>99.9900</td>\n",
       "      <td>179.9800</td>\n",
       "      <td>319.9700</td>\n",
       "      <td>3019.8820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>customer_value_total_ever_online</th>\n",
       "      <td>19945.0000</td>\n",
       "      <td>489.7054</td>\n",
       "      <td>632.6064</td>\n",
       "      <td>12.9900</td>\n",
       "      <td>149.9800</td>\n",
       "      <td>286.4600</td>\n",
       "      <td>578.4400</td>\n",
       "      <td>7799.5410</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                       count     mean      std     min      25%      50%      75%       max\n",
       "order_num_total_ever_online       19945.0000   3.0923   3.8137  1.0000   1.0000   2.0000   4.0000   48.5000\n",
       "order_num_total_ever_offline      19945.0000   1.8862   1.4347  1.0000   1.0000   1.0000   2.0000   16.0000\n",
       "customer_value_total_ever_offline 19945.0000 251.9212 251.0226 10.0000  99.9900 179.9800 319.9700 3019.8820\n",
       "customer_value_total_ever_online  19945.0000 489.7054 632.6064 12.9900 149.9800 286.4600 578.4400 7799.5410"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "for d in data:\n",
    "    replace_with_thresholds(df,d)\n",
    "\n",
    "df[data].describe().T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "991026f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.738493Z",
     "iopub.status.busy": "2024-09-10T19:13:14.737514Z",
     "iopub.status.idle": "2024-09-10T19:13:14.750314Z",
     "shell.execute_reply": "2024-09-10T19:13:14.748564Z"
    },
    "papermill": {
     "duration": 0.027577,
     "end_time": "2024-09-10T19:13:14.754411",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.726834",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Adım4:  Omnichannel müşterilerin hem online'dan hem de offline platformlardan alışveriş yaptığını ifade etmektedir. Her bir müşterinin toplam alışveriş sayısı ve harcaması için yeni değişkenler oluşturunuz.\n",
    "\n",
    "df[\"total_order\"]=(df[\"order_num_total_ever_online\"]+df[\"order_num_total_ever_offline\"])\n",
    "df[\"total_spend\"]=(df[\"customer_value_total_ever_offline\"]+df[\"customer_value_total_ever_online\"]).astype(float).round().astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "32fcdec9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.774319Z",
     "iopub.status.busy": "2024-09-10T19:13:14.773835Z",
     "iopub.status.idle": "2024-09-10T19:13:14.838043Z",
     "shell.execute_reply": "2024-09-10T19:13:14.836388Z"
    },
    "papermill": {
     "duration": 0.07957,
     "end_time": "2024-09-10T19:13:14.842937",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.763367",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "master_id                                    object\n",
       "order_channel                                object\n",
       "last_order_channel                           object\n",
       "first_order_date                     datetime64[ns]\n",
       "last_order_date                      datetime64[ns]\n",
       "last_order_date_online               datetime64[ns]\n",
       "last_order_date_offline              datetime64[ns]\n",
       "order_num_total_ever_online                 float64\n",
       "order_num_total_ever_offline                float64\n",
       "customer_value_total_ever_offline           float64\n",
       "customer_value_total_ever_online            float64\n",
       "interested_in_categories_12                  object\n",
       "total_order                                 float64\n",
       "total_spend                                   int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Adım5:  Değişkentiplerini inceleyiniz. Tarih ifade eden değişkenlerin tipini date'e çeviriniz.\n",
    "df.dtypes\n",
    "date_columns = [\"first_order_date\", \"last_order_date\", \"last_order_date_online\", \"last_order_date_offline\"]\n",
    "df[date_columns] = df[date_columns].apply(pd.to_datetime)\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "424608a5",
   "metadata": {
    "_kg_hide-input": true,
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.874331Z",
     "iopub.status.busy": "2024-09-10T19:13:14.873658Z",
     "iopub.status.idle": "2024-09-10T19:13:14.887354Z",
     "shell.execute_reply": "2024-09-10T19:13:14.885248Z"
    },
    "papermill": {
     "duration": 0.033811,
     "end_time": "2024-09-10T19:13:14.891760",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.857949",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-05-30 00:00:00\n"
     ]
    }
   ],
   "source": [
    "#Görev 2:  CLTV Veri Yapısının Oluşturulması\n",
    "# recency: Son satın alma üzerinden geçen zaman. Haftalık. (kullanıcı özelinde)\n",
    "# T: Müşterinin yaşı. Haftalık. (analiz tarihinden ne kadar süre önce ilk satın alma yapılmış)\n",
    "# frequency: tekrar eden toplam satın alma sayısı (frequency>1)\n",
    "# monetary: satın alma başına ortalama kazanç\n",
    "\n",
    "# Adım1:  Veri setindeki en son alışverişin yapıldığı tarihten 2 gün sonrasını analiz tarihi olarak alınız.\n",
    "print(df[\"last_order_date\"].max())\n",
    "today_date = dt.datetime(2021, 6, 1)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e0e98500",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.912723Z",
     "iopub.status.busy": "2024-09-10T19:13:14.912120Z",
     "iopub.status.idle": "2024-09-10T19:13:14.925341Z",
     "shell.execute_reply": "2024-09-10T19:13:14.923481Z"
    },
    "papermill": {
     "duration": 0.027184,
     "end_time": "2024-09-10T19:13:14.928528",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.901344",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "master_id                                    object\n",
       "order_channel                                object\n",
       "last_order_channel                           object\n",
       "first_order_date                     datetime64[ns]\n",
       "last_order_date                      datetime64[ns]\n",
       "last_order_date_online               datetime64[ns]\n",
       "last_order_date_offline              datetime64[ns]\n",
       "order_num_total_ever_online                 float64\n",
       "order_num_total_ever_offline                float64\n",
       "customer_value_total_ever_offline           float64\n",
       "customer_value_total_ever_online            float64\n",
       "interested_in_categories_12                  object\n",
       "total_order                                 float64\n",
       "total_spend                                   int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3ab0704d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:14.953146Z",
     "iopub.status.busy": "2024-09-10T19:13:14.952546Z",
     "iopub.status.idle": "2024-09-10T19:13:14.980636Z",
     "shell.execute_reply": "2024-09-10T19:13:14.979287Z"
    },
    "papermill": {
     "duration": 0.045227,
     "end_time": "2024-09-10T19:13:14.983560",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.938333",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>cc294636-19f0-11eb-8d74-000d3a38a36f</td>\n",
       "      <td>17.0000</td>\n",
       "      <td>30.5714</td>\n",
       "      <td>5</td>\n",
       "      <td>187.8000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>f431bd5a-ab7b-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>209.8571</td>\n",
       "      <td>224.8571</td>\n",
       "      <td>21</td>\n",
       "      <td>95.9048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>69b69676-1a40-11ea-941b-000d3a38a36f</td>\n",
       "      <td>52.2857</td>\n",
       "      <td>78.8571</td>\n",
       "      <td>5</td>\n",
       "      <td>117.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1854e56c-491f-11eb-806e-000d3a38a36f</td>\n",
       "      <td>1.5714</td>\n",
       "      <td>20.8571</td>\n",
       "      <td>2</td>\n",
       "      <td>61.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d6ea1074-f1f5-11e9-9346-000d3a38a36f</td>\n",
       "      <td>83.1429</td>\n",
       "      <td>95.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>105.0000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                            customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg\n",
       "0  cc294636-19f0-11eb-8d74-000d3a38a36f              17.0000   30.5714          5           187.8000\n",
       "1  f431bd5a-ab7b-11e9-a2fc-000d3a38a36f             209.8571  224.8571         21            95.9048\n",
       "2  69b69676-1a40-11ea-941b-000d3a38a36f              52.2857   78.8571          5           117.0000\n",
       "3  1854e56c-491f-11eb-806e-000d3a38a36f               1.5714   20.8571          2            61.0000\n",
       "4  d6ea1074-f1f5-11e9-9346-000d3a38a36f              83.1429   95.4286          2           105.0000"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Adım2:  customer_id, recency_cltv_weekly, T_weekly, frequency ve monetary_cltv_avg değerlerinin yer aldığı yeni bir cltv dataframe'i oluşturunuz. Monetary değeri satın alma başına ortalama değer olarak, recency ve tenure değerleri ise haftalık cinsten ifade edilecek.\n",
    "import numpy as np\n",
    "data = {\"customer_id\":df[\"master_id\"] ,\n",
    "        'recency_cltv_weekly':((df['last_order_date']-df['first_order_date'])/ np.timedelta64(1, 'D'))/7,\n",
    "      \"T_weekly\":((today_date-df[\"first_order_date\"])/ np.timedelta64(1, 'D'))/7,\n",
    "       \"frequency\":df[\"total_order\"].astype(int),\n",
    "       \"monetary_cltv_avg\":df[\"total_spend\"]/df[\"total_order\"]}\n",
    "\n",
    "cltv_df = pd.DataFrame(data)\n",
    "cltv_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f24436c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:15.006459Z",
     "iopub.status.busy": "2024-09-10T19:13:15.005125Z",
     "iopub.status.idle": "2024-09-10T19:13:15.883571Z",
     "shell.execute_reply": "2024-09-10T19:13:15.880906Z"
    },
    "papermill": {
     "duration": 0.897259,
     "end_time": "2024-09-10T19:13:15.890540",
     "exception": false,
     "start_time": "2024-09-10T19:13:14.993281",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in sqrt\n",
      "  result = getattr(ufunc, method)(*inputs, **kwargs)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<lifetimes.BetaGeoFitter: fitted with 19945 subjects, a: 0.00, alpha: 76.17, b: 0.00, r: 3.66>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bgf = BetaGeoFitter(penalizer_coef=0.001)\n",
    "\n",
    "bgf.fit(cltv_df['frequency'],\n",
    "        cltv_df['recency_cltv_weekly'],\n",
    "        cltv_df['T_weekly'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "cf6f6cdd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:15.935628Z",
     "iopub.status.busy": "2024-09-10T19:13:15.934771Z",
     "iopub.status.idle": "2024-09-10T19:13:16.005586Z",
     "shell.execute_reply": "2024-09-10T19:13:16.004168Z"
    },
    "papermill": {
     "duration": 0.098141,
     "end_time": "2024-09-10T19:13:16.008900",
     "exception": false,
     "start_time": "2024-09-10T19:13:15.910759",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "      <th>exp_sales_3_month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>cc294636-19f0-11eb-8d74-000d3a38a36f</td>\n",
       "      <td>17.0000</td>\n",
       "      <td>30.5714</td>\n",
       "      <td>5</td>\n",
       "      <td>187.8000</td>\n",
       "      <td>0.9739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>f431bd5a-ab7b-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>209.8571</td>\n",
       "      <td>224.8571</td>\n",
       "      <td>21</td>\n",
       "      <td>95.9048</td>\n",
       "      <td>0.9832</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>69b69676-1a40-11ea-941b-000d3a38a36f</td>\n",
       "      <td>52.2857</td>\n",
       "      <td>78.8571</td>\n",
       "      <td>5</td>\n",
       "      <td>117.0000</td>\n",
       "      <td>0.6706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1854e56c-491f-11eb-806e-000d3a38a36f</td>\n",
       "      <td>1.5714</td>\n",
       "      <td>20.8571</td>\n",
       "      <td>2</td>\n",
       "      <td>61.0000</td>\n",
       "      <td>0.7004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d6ea1074-f1f5-11e9-9346-000d3a38a36f</td>\n",
       "      <td>83.1429</td>\n",
       "      <td>95.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>105.0000</td>\n",
       "      <td>0.3960</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                            customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg  exp_sales_3_month\n",
       "0  cc294636-19f0-11eb-8d74-000d3a38a36f              17.0000   30.5714          5           187.8000             0.9739\n",
       "1  f431bd5a-ab7b-11e9-a2fc-000d3a38a36f             209.8571  224.8571         21            95.9048             0.9832\n",
       "2  69b69676-1a40-11ea-941b-000d3a38a36f              52.2857   78.8571          5           117.0000             0.6706\n",
       "3  1854e56c-491f-11eb-806e-000d3a38a36f               1.5714   20.8571          2            61.0000             0.7004\n",
       "4  d6ea1074-f1f5-11e9-9346-000d3a38a36f              83.1429   95.4286          2           105.0000             0.3960"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# • 3 ay içerisinde müşterilerden beklenen satın almaları tahmin ediniz ve exp_sales_3_month olarak cltv dataframe'ine ekleyiniz.\n",
    "\n",
    "\n",
    "bgf.conditional_expected_number_of_purchases_up_to_time(1,\n",
    " cltv_df['frequency'],\n",
    "                                                        cltv_df['recency_cltv_weekly'],\n",
    "                                                        cltv_df['T_weekly']).sort_values(ascending=False).head(10)\n",
    "\n",
    "\n",
    "cltv_df[\"exp_sales_3_month\"] = bgf.predict(4*3,\n",
    "                                              cltv_df['frequency'],\n",
    "                                              cltv_df['recency_cltv_weekly'],\n",
    "                                              cltv_df['T_weekly'])\n",
    "\n",
    "cltv_df.head()\n",
    "#yorum:ilgili kişi %97 olasılıkla(oranla) alışveriş yapacak"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c94047ab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:16.035127Z",
     "iopub.status.busy": "2024-09-10T19:13:16.034571Z",
     "iopub.status.idle": "2024-09-10T19:13:16.077595Z",
     "shell.execute_reply": "2024-09-10T19:13:16.076552Z"
    },
    "papermill": {
     "duration": 0.059553,
     "end_time": "2024-09-10T19:13:16.081609",
     "exception": false,
     "start_time": "2024-09-10T19:13:16.022056",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "      <th>exp_sales_3_month</th>\n",
       "      <th>exp_sales_6_month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>cc294636-19f0-11eb-8d74-000d3a38a36f</td>\n",
       "      <td>17.0000</td>\n",
       "      <td>30.5714</td>\n",
       "      <td>5</td>\n",
       "      <td>187.8000</td>\n",
       "      <td>0.9739</td>\n",
       "      <td>1.9479</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>f431bd5a-ab7b-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>209.8571</td>\n",
       "      <td>224.8571</td>\n",
       "      <td>21</td>\n",
       "      <td>95.9048</td>\n",
       "      <td>0.9832</td>\n",
       "      <td>1.9663</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>69b69676-1a40-11ea-941b-000d3a38a36f</td>\n",
       "      <td>52.2857</td>\n",
       "      <td>78.8571</td>\n",
       "      <td>5</td>\n",
       "      <td>117.0000</td>\n",
       "      <td>0.6706</td>\n",
       "      <td>1.3412</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1854e56c-491f-11eb-806e-000d3a38a36f</td>\n",
       "      <td>1.5714</td>\n",
       "      <td>20.8571</td>\n",
       "      <td>2</td>\n",
       "      <td>61.0000</td>\n",
       "      <td>0.7004</td>\n",
       "      <td>1.4008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d6ea1074-f1f5-11e9-9346-000d3a38a36f</td>\n",
       "      <td>83.1429</td>\n",
       "      <td>95.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>105.0000</td>\n",
       "      <td>0.3960</td>\n",
       "      <td>0.7921</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                            customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg  exp_sales_3_month  exp_sales_6_month \n",
       "0  cc294636-19f0-11eb-8d74-000d3a38a36f              17.0000   30.5714          5           187.8000             0.9739              1.9479\n",
       "1  f431bd5a-ab7b-11e9-a2fc-000d3a38a36f             209.8571  224.8571         21            95.9048             0.9832              1.9663\n",
       "2  69b69676-1a40-11ea-941b-000d3a38a36f              52.2857   78.8571          5           117.0000             0.6706              1.3412\n",
       "3  1854e56c-491f-11eb-806e-000d3a38a36f               1.5714   20.8571          2            61.0000             0.7004              1.4008\n",
       "4  d6ea1074-f1f5-11e9-9346-000d3a38a36f              83.1429   95.4286          2           105.0000             0.3960              0.7921"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#• 6 ay içerisinde müşterilerden beklenen satın almaları tahmin ediniz ve exp_sales_6_month olarak cltv dataframe'ine ekleyiniz.\n",
    "cltv_df[\"exp_sales_6_month \"] = bgf.predict(4*6,\n",
    "                                              cltv_df['frequency'],\n",
    "                                              cltv_df['recency_cltv_weekly'],\n",
    "                                              cltv_df['T_weekly'])\n",
    "cltv_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "e571fa2a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:16.116798Z",
     "iopub.status.busy": "2024-09-10T19:13:16.115648Z",
     "iopub.status.idle": "2024-09-10T19:13:20.653233Z",
     "shell.execute_reply": "2024-09-10T19:13:20.651876Z"
    },
    "papermill": {
     "duration": 4.557123,
     "end_time": "2024-09-10T19:13:20.656012",
     "exception": false,
     "start_time": "2024-09-10T19:13:16.098889",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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ICLKQ85wulKplH4R58Xc3BwGBgbSiNKb4uLiVKZzRm0eP36sMv/tv17Nzc1hbGyMrKysd267IHL6c/ny5feuc/DgwViwYAF27dqFffv2wdzc/L2n/8zNzWFoaJirz8Dru7S0tLRga2urfgfe8s0332DlypWYPn26dHdQ9erV8fTp0w/eZ3kds6tXr0p3L+WMBOjo6Lx3nZs3b0bbtm2xatUqlfmPHz9WuXhfndNB6jh27BhSUlKwdetWtG7dWpofHx//UestX748+vbti759+yIzMxO9evXCnDlzMG3aNOjr62Pz5s0YMmQIFixYIL0nPT0912e+evXqed7R96aC7Cs7OzscOnQIT548URklyjk1mHNnY0FZW1tjzJgxGDNmDO7du4cGDRpgzpw5DERlFK8hIspDw4YNUb16dfzwww94+vRpruU5z9LR1taGh4cHtm/fjtu3b0vLY2JicODAAZX3KJVKVKpUKde1LG8/R0dbWxteXl7YsmVLnr80crZdEA0aNICDgwMWLVqU65fT26NILi4ucHFxwa+//ootW7agX79+KFfu3X87aWtro1OnTtixY4fKLdbJycn4/fff0bJlSyiVygLXnR9TU1N8+eWXOHDggPQk4z59+iAsLCzXfgdeB5NXr16pzNu+fbvKYwTCw8Nx9uxZ6ZedhYUF2rRpg59//hl3797Ntc43j4O2tnau/bhp06ZcjykoX768VE9RyhkBebOmzMzMj3pmU0pKisq0rq4unJ2dIYTAy5cvpe2+vR9++umnXKOgXl5euHDhArZt25ZrOznvL8i+ynlo59KlS1XmL1y4EAqFosABJisrK9dpRQsLC9jY2BRoVJhKF44QEeVBS0sLv/76K7p06YI6depg6NChqFy5Mv79918cPXoUSqUSu3btAgDMmjUL+/fvR6tWrTBmzBi8evVKel7Lm9dgAMCIESMQFBSEESNGoFGjRjhx4gSuXr2aa/tBQUE4evQomjZtipEjR8LZ2RkPHz7EuXPncOjQITx8+LDA/Vm+fDm6d++O+vXrY+jQobC2tkZsbCyuXLmSK0QMHjwYkyZNApD7AYH5+e9//4vQ0FC0bNkSY8aMQbly5fDzzz8jIyMjz2fafKzx48dj0aJFCAoKwp9//gl/f3/s3LkT3bp1wxdffIGGDRvi2bNnuHTpEjZv3oybN2+qjNY4Ojqi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7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsldN0AUREhcl+6p4Cv+dmkGcRVEJEpQlHiIiIiEj2GIiIiIhI9hiIiIiISPYYiIiIiEj2GIiIiIhI9jQaiJYvXw4XFxcolUoolUq4ublh37590vL09HR4e3ujYsWKMDIygpeXF5KTk1XWcfv2bXh6esLQ0BAWFhbw9/fHq1evVNocO3YMDRo0gJ6eHhwdHRESElIc3SMiIqJSQqOBqEqVKggKCkJkZCT+/vtvtGvXDj169MCVK1cAABMmTMCuXbuwadMmHD9+HImJiejVq5f0/qysLHh6eiIzMxOnT5/G2rVrERISghkzZkht4uPj4enpibZt2yIqKgq+vr4YMWIEDhw4UOz9JSIiopJJIYQQmi7iTWZmZpg/fz569+4Nc3Nz/P777+jduzcAIDY2Fk5OTggLC0OzZs2wb98+dOvWDYmJibC0tAQArFixAlOmTMH9+/ehq6uLKVOmYM+ePbh8+bK0jX79+uHx48fYv3//B9WUlpYGExMTpKamQqlUFn6nqcRR51k2QOl5nk1ZflZPWe4bERVMQX5/l5hriLKysvDnn3/i2bNncHNzQ2RkJF6+fIkOHTpIbWrXro2qVasiLCwMABAWFoZ69epJYQgAPDw8kJaWJo0yhYWFqawjp03OOvKSkZGBtLQ0lRcRERGVXRoPRJcuXYKRkRH09PQwevRobNu2Dc7OzkhKSoKuri5MTU1V2ltaWiIpKQkAkJSUpBKGcpbnLHtXm7S0NLx48SLPmubOnQsTExPpZWtrWxhdJSIiohJK44GoVq1aiIqKwtmzZ/HVV19hyJAhiI6O1mhN06ZNQ2pqqvRKSEjQaD1ERERUtDT+XWa6urpwdHQEADRs2BARERFYvHgx+vbti8zMTDx+/FhllCg5ORlWVlYAACsrK4SHh6usL+cutDfbvH1nWnJyMpRKJQwMDPKsSU9PD3p6eoXSPyIiIir5ND5C9Lbs7GxkZGSgYcOG0NHRweHDh6VlcXFxuH37Ntzc3AAAbm5uuHTpEu7duye1CQ0NhVKphLOzs9TmzXXktMlZBxEREZFagWj//v04efKkNB0cHIz69eujf//+ePTo0QevZ9q0aThx4gRu3ryJS5cuYdq0aTh27BgGDBgAExMTDB8+HH5+fjh69CgiIyMxdOhQuLm5oVmzZgCATp06wdnZGYMGDcKFCxdw4MABTJ8+Hd7e3tIIz+jRo3Hjxg1MnjwZsbGxWLZsGTZu3IgJEyao03UiIiIqg9QKRP7+/tKdV5cuXcLEiRPRtWtXxMfHw8/P74PXc+/ePQwePBi1atVC+/btERERgQMHDqBjx44AgIULF6Jbt27w8vJC69atYWVlha1bt0rv19bWxu7du6GtrQ03NzcMHDgQgwcPRmBgoNTGwcEBe/bsQWhoKFxdXbFgwQL8+uuv8PDwUKfrREREVAapdQ1RfHy8dEpqy5Yt6NatG7777jucO3cOXbt2/eD1rFq16p3L9fX1ERwcjODg4Hzb2NnZYe/eve9cT5s2bXD+/PkProuIiIjkRa0RIl1dXTx//hwAcOjQIXTq1AnA64cq8pk9REREVNqoNULUokUL+Pn5oUWLFggPD8eGDRsAAFevXkWVKlUKtUAiIiKioqbWCFFwcDB0dHSwefNmLF++HJUrVwYA7Nu3D507dy7UAomIiIiKWoFHiF69eoVjx45h5cqV0rN+cixcuLDQCiMiIiIqLgUeISpXrhxGjx6NjIyMoqiHiIiIqNipdcqsSZMmvGuLiIiIygy1LqoeM2YMJk6ciDt37qBhw4YoX768ynIXF5dCKY6IiIioOKgViPr16wcAGDdunDRPoVBACAGFQoGsrKzCqY6IiIioGKj9YEYiIiKiskKtQGRnZ1fYdRARERFpjNrfdr9u3Tq0aNECNjY2uHXrFgBg0aJF2LFjR6EVR0RERFQc1ApEy5cvh5+fH7p27YrHjx9L1wyZmppi0aJFhVkfERERUZFTKxD99NNPWLlyJb755htoa2tL8xs1aoRLly4VWnFERERExUGtQBQfH49PPvkk13w9PT08e/bso4siIiIiKk5qBSIHBwdERUXlmr9//344OTl9bE1ERERExUqtu8z8/Pzg7e2N9PR0CCEQHh6OP/74A3PnzsWvv/5a2DUSERERFSm1AtGIESNgYGCA6dOn4/nz5+jfvz9sbGywePFi6aGNRERERKWFWoEIAAYMGIABAwbg+fPnePr0KSwsLAqzLiIiIqJio3YgymFoaAhDQ8PCqIWIiIhII9QKRCkpKZgxYwaOHj2Ke/fuITs7W2X5w4cPC6U4IiIiouKgViAaNGgQ/vnnHwwfPhyWlpZQKBSFXRcRERFRsVErEP311184efIkXF1dC7seIiIiomKn1nOIateujRcvXhR2LUREREQaoVYgWrZsGb755hscP34cKSkpSEtLU3kRERERlSZqnTIzNTVFWloa2rVrpzJfCAGFQiF92SsRERFRaaBWIBowYAB0dHTw+++/86JqIiIiKvXUCkSXL1/G+fPnUatWrcKuh4iIiKjYqXUNUaNGjZCQkFDYtRARERFphFojRGPHjsX48ePh7++PevXqQUdHR2W5i4tLoRRHVOoEmKj5vtTCrYOIiApErUDUt29fAMCwYcOkeQqFghdVE5VlDHtEVIapFYji4+MLuw4iIiIijVErENnZ2RV2HUREREQao/a33V+/fh2LFi1CTEwMAMDZ2Rnjx49H9erVC604IiIiouKg1l1mBw4cgLOzM8LDw+Hi4gIXFxecPXsWderUQWhoaGHXSERERFSk1Bohmjp1KiZMmICgoKBc86dMmYKOHTsWSnFERERExUGtEaKYmBgMHz481/xhw4YhOjr6o4siIiIiKk5qBSJzc3NERUXlmh8VFQULC4uPrYmIiIioWKl1ymzkyJEYNWoUbty4gebNmwMATp06he+//x5+fn6FWiARERFRUVMrEH377bcwNjbGggULMG3aNACAjY0NAgICMG7cuEItkIiIiKioqRWIFAoFJkyYgAkTJuDJkycAAGNj40ItjMowPvGYiIhKGLWuIWrXrh0eP34M4HUQyglDaWlpaNeuXaEVR0RERFQc1ApEx44dQ2ZmZq756enp+Ouvvz66KCIiIqLiVKBTZhcvXpT+HR0djaSkJGk6KysL+/fvR+XKlQuvOiIiIqJiUKBAVL9+fSgUCigUijxPjRkYGOCnn34qtOKIiIiIikOBAlF8fDyEEKhWrRrC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JHsMRERERCR7DEREREQkexp9UjURERWDABM13pNa+HUQlWAcISIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2Sun6QIoHwEmar4vtXDrICIikgGOEBEREZHsMRARERGR7PGUGRERaZz91D1qve9mkGchV0JyxREiIiIikj0GIiIiIpI9BiIiIiKSPQYiIiIikj1eVE1ERKWXOs9s4/PaKA8cISIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZYyAiIiIi2WMgIiIiItljICIiIiLZK6fJjZ84cQLz589HZGQk7t69i23btqFnz57SciEEZs6ciZUrV+Lx48do0aIFli9fjho1akhtHj58iLFjx2LXrl3Q0tKCl5cXFi9eDCMjI6nNxYsX4e3tjYiICJibm2Ps2LGYPHlycXaViIhkyn7qHrXedzPIs5AroXfR6AjRs2fP4OrqiuDg4DyXz5s3D0uWLMGKFStw9uxZlC9fHh4eHkhPT5faDBgwAFeuXEFoaCh2796NEydOYNSoUdLytLQ0dOrUCXZ2doiMjMT8+fMREBCAX375pcj7R0RERKWDRkeIunTpgi5duuS5TAiBRYsWYfr06ejRowcA4LfffoOlpSW2b9+Ofv36ISYmBvv370dERAQaNWoEAPjpp5/QtWtX/PDDD7CxscH69euRmZmJ1atXQ1dXF3Xq1EFUVBR+/PFHleBERERE8lViryGKj49HUlISOnToIM0zMTFB06ZNERYWBgAICwuDqampFIYAoEOHDtDS0sLZs2elNq1bt4aurq7UxsPDA3FxcXj06FGe287IyEBaWprKi4iIiMquEhuIkpKSAACWlpYq8y0tLaVlSUlJsLCwUFlerlw5mJmZqbTJax1vbuNtc+fOhYmJifSytbX9+A4RERFRiVViA5EmTZs2DampqdIrISFB0yURERFRESqxgcjKygoAkJycrDI/OTlZWmZlZYV79+6pLH/16hUePnyo0iavdby5jbfp6elBqVSqvIiIiKjsKrGByMHBAVZWVjh8+LA0Ly0tDWfPnoWbmxsAwM3NDY8fP0ZkZKTU5siRI8jOzkbTpk2lNidOnMDLly+lNqGhoahVqxYqVKhQTL0hIiKikkyjgejp06eIiopCVFQUgNcXUkdFReH27dtQKBTw9fXFf//7X+zcuROXLl3C4MGDYWNjIz2ryMnJCZ07d8bIkSMRHh6OU6dOwcfHB/369YONjQ0AoH///tDV1cXw4cNx5coVbNiwAYsXL4afn5+Gek1EREQljUZvu//777/Rtm1baTonpAwZMgQhISGYPHkynj17hlGjRuHx48do2bIl9u/fD319fek969evh4+PD9q3by89mHHJkiXSchMTExw8eBDe3t5o2LAhKlWqhBkzZvCWeyIiIpJoNBC1adMGQoh8lysUCgQGBiIwMDDfNmZmZvj999/fuR0XFxf89ddfatdJREREZVuJvYaIiIiIqLgwEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkewxEBEREZHsMRARERGR7DEQERERkeyV03QBREREVDrZT92j1vtuBnkWciUfjyNEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxEREREJHsMRERERCR7DEREREQkewxERERE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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#tahmin sonuçlarının değerlendirmesi\n",
    "plot_period_transactions(bgf)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2d792e48",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:20.682852Z",
     "iopub.status.busy": "2024-09-10T19:13:20.682013Z",
     "iopub.status.idle": "2024-09-10T19:13:20.872734Z",
     "shell.execute_reply": "2024-09-10T19:13:20.871419Z"
    },
    "papermill": {
     "duration": 0.207758,
     "end_time": "2024-09-10T19:13:20.875523",
     "exception": false,
     "start_time": "2024-09-10T19:13:20.667765",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "      <th>exp_sales_3_month</th>\n",
       "      <th>exp_sales_6_month</th>\n",
       "      <th>exp_average_value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9055</th>\n",
       "      <td>47a642fe-975b-11eb-8c2a-000d3a38a36f</td>\n",
       "      <td>2.8571</td>\n",
       "      <td>7.8571</td>\n",
       "      <td>4</td>\n",
       "      <td>1401.7500</td>\n",
       "      <td>1.0944</td>\n",
       "      <td>2.1888</td>\n",
       "      <td>1449.0079</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17323</th>\n",
       "      <td>f59053e2-a503-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>51.7143</td>\n",
       "      <td>101.0000</td>\n",
       "      <td>7</td>\n",
       "      <td>1106.4286</td>\n",
       "      <td>0.7222</td>\n",
       "      <td>1.4445</td>\n",
       "      <td>1127.5718</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15516</th>\n",
       "      <td>9083981a-f59e-11e9-841e-000d3a38a36f</td>\n",
       "      <td>63.5714</td>\n",
       "      <td>83.8571</td>\n",
       "      <td>4</td>\n",
       "      <td>1090.2500</td>\n",
       "      <td>0.5746</td>\n",
       "      <td>1.1493</td>\n",
       "      <td>1127.2401</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6402</th>\n",
       "      <td>851de3b4-8f0c-11eb-8cb8-000d3a38a36f</td>\n",
       "      <td>8.2857</td>\n",
       "      <td>9.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>862.5000</td>\n",
       "      <td>0.7939</td>\n",
       "      <td>1.5878</td>\n",
       "      <td>923.4758</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16410</th>\n",
       "      <td>6fecd6c8-261a-11ea-8e1c-000d3a38a36f</td>\n",
       "      <td>57.0000</td>\n",
       "      <td>94.8571</td>\n",
       "      <td>2</td>\n",
       "      <td>859.5000</td>\n",
       "      <td>0.3974</td>\n",
       "      <td>0.7947</td>\n",
       "      <td>920.2713</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1853</th>\n",
       "      <td>f02473b0-43c3-11eb-806e-000d3a38a36f</td>\n",
       "      <td>17.2857</td>\n",
       "      <td>23.1429</td>\n",
       "      <td>2</td>\n",
       "      <td>836.0000</td>\n",
       "      <td>0.6843</td>\n",
       "      <td>1.3686</td>\n",
       "      <td>895.1693</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7936</th>\n",
       "      <td>ae4ce104-dbd4-11ea-8757-000d3a38a36f</td>\n",
       "      <td>3.7143</td>\n",
       "      <td>42.0000</td>\n",
       "      <td>3</td>\n",
       "      <td>844.3333</td>\n",
       "      <td>0.6766</td>\n",
       "      <td>1.3533</td>\n",
       "      <td>883.2734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9738</th>\n",
       "      <td>3a27b334-dff4-11ea-acaa-000d3a38a36f</td>\n",
       "      <td>40.0000</td>\n",
       "      <td>41.1429</td>\n",
       "      <td>3</td>\n",
       "      <td>837.0000</td>\n",
       "      <td>0.6816</td>\n",
       "      <td>1.3632</td>\n",
       "      <td>875.6142</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12828</th>\n",
       "      <td>0c24fc44-2ac8-11ea-9d27-000d3a38a36f</td>\n",
       "      <td>68.0000</td>\n",
       "      <td>84.2857</td>\n",
       "      <td>2</td>\n",
       "      <td>779.5000</td>\n",
       "      <td>0.4235</td>\n",
       "      <td>0.8471</td>\n",
       "      <td>834.8176</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2291</th>\n",
       "      <td>26ac1432-1dd3-11ea-8bf2-000d3a38a36f</td>\n",
       "      <td>55.7143</td>\n",
       "      <td>97.7143</td>\n",
       "      <td>3</td>\n",
       "      <td>780.6667</td>\n",
       "      <td>0.4598</td>\n",
       "      <td>0.9197</td>\n",
       "      <td>816.7775</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg  exp_sales_3_month  exp_sales_6_month   exp_average_value\n",
       "9055   47a642fe-975b-11eb-8c2a-000d3a38a36f               2.8571    7.8571          4          1401.7500             1.0944              2.1888          1449.0079\n",
       "17323  f59053e2-a503-11e9-a2fc-000d3a38a36f              51.7143  101.0000          7          1106.4286             0.7222              1.4445          1127.5718\n",
       "15516  9083981a-f59e-11e9-841e-000d3a38a36f              63.5714   83.8571          4          1090.2500             0.5746              1.1493          1127.2401\n",
       "6402   851de3b4-8f0c-11eb-8cb8-000d3a38a36f               8.2857    9.4286          2           862.5000             0.7939              1.5878           923.4758\n",
       "16410  6fecd6c8-261a-11ea-8e1c-000d3a38a36f              57.0000   94.8571          2           859.5000             0.3974              0.7947           920.2713\n",
       "1853   f02473b0-43c3-11eb-806e-000d3a38a36f              17.2857   23.1429          2           836.0000             0.6843              1.3686           895.1693\n",
       "7936   ae4ce104-dbd4-11ea-8757-000d3a38a36f               3.7143   42.0000          3           844.3333             0.6766              1.3533           883.2734\n",
       "9738   3a27b334-dff4-11ea-acaa-000d3a38a36f              40.0000   41.1429          3           837.0000             0.6816              1.3632           875.6142\n",
       "12828  0c24fc44-2ac8-11ea-9d27-000d3a38a36f              68.0000   84.2857          2           779.5000             0.4235              0.8471           834.8176\n",
       "2291   26ac1432-1dd3-11ea-8bf2-000d3a38a36f              55.7143   97.7143          3           780.6667             0.4598              0.9197           816.7775"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Adım2:  Gamma-Gamma modelini fit ediniz. Müşterilerin ortalama bırakacakları değeri tahminleyip exp_average_value olarak cltv dataframe'ine ekleyiniz\n",
    "ggf = GammaGammaFitter(penalizer_coef=0.01)\n",
    "\n",
    "ggf.fit(cltv_df['frequency'], cltv_df['monetary_cltv_avg'])\n",
    "\n",
    "cltv_df[\"exp_average_value\"] = ggf.conditional_expected_average_profit(\n",
    "    cltv_df['frequency'],\n",
    "    cltv_df['monetary_cltv_avg'])\n",
    "cltv_df.sort_values(\"exp_average_value\", ascending=False).head(10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "cc333798",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:20.901499Z",
     "iopub.status.busy": "2024-09-10T19:13:20.900966Z",
     "iopub.status.idle": "2024-09-10T19:13:21.117199Z",
     "shell.execute_reply": "2024-09-10T19:13:21.115775Z"
    },
    "papermill": {
     "duration": 0.231992,
     "end_time": "2024-09-10T19:13:21.119964",
     "exception": false,
     "start_time": "2024-09-10T19:13:20.887972",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "      <th>exp_sales_3_month</th>\n",
       "      <th>exp_sales_6_month</th>\n",
       "      <th>exp_average_value</th>\n",
       "      <th>cltv</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9055</th>\n",
       "      <td>47a642fe-975b-11eb-8c2a-000d3a38a36f</td>\n",
       "      <td>2.8571</td>\n",
       "      <td>7.8571</td>\n",
       "      <td>4</td>\n",
       "      <td>1401.7500</td>\n",
       "      <td>1.0944</td>\n",
       "      <td>2.1888</td>\n",
       "      <td>1449.0079</td>\n",
       "      <td>3327.6564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13880</th>\n",
       "      <td>7137a5c0-7aad-11ea-8f20-000d3a38a36f</td>\n",
       "      <td>6.1429</td>\n",
       "      <td>13.1429</td>\n",
       "      <td>11</td>\n",
       "      <td>758.0000</td>\n",
       "      <td>1.9701</td>\n",
       "      <td>3.9402</td>\n",
       "      <td>767.2740</td>\n",
       "      <td>3172.0363</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17323</th>\n",
       "      <td>f59053e2-a503-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>51.7143</td>\n",
       "      <td>101.0000</td>\n",
       "      <td>7</td>\n",
       "      <td>1106.4286</td>\n",
       "      <td>0.7222</td>\n",
       "      <td>1.4445</td>\n",
       "      <td>1127.5718</td>\n",
       "      <td>1708.9219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12438</th>\n",
       "      <td>625f40a2-5bd2-11ea-98b0-000d3a38a36f</td>\n",
       "      <td>74.2857</td>\n",
       "      <td>74.5714</td>\n",
       "      <td>16</td>\n",
       "      <td>501.8750</td>\n",
       "      <td>1.5653</td>\n",
       "      <td>3.1306</td>\n",
       "      <td>506.1678</td>\n",
       "      <td>1662.6174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8868</th>\n",
       "      <td>9ce6e520-89b0-11ea-a6e7-000d3a38a36f</td>\n",
       "      <td>3.4286</td>\n",
       "      <td>34.4286</td>\n",
       "      <td>8</td>\n",
       "      <td>601.2500</td>\n",
       "      <td>1.2655</td>\n",
       "      <td>2.5309</td>\n",
       "      <td>611.5166</td>\n",
       "      <td>1623.8763</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7330</th>\n",
       "      <td>a4d534a2-5b1b-11eb-8dbd-000d3a38a36f</td>\n",
       "      <td>62.7143</td>\n",
       "      <td>67.2857</td>\n",
       "      <td>52</td>\n",
       "      <td>164.6286</td>\n",
       "      <td>4.6561</td>\n",
       "      <td>9.3123</td>\n",
       "      <td>165.1123</td>\n",
       "      <td>1613.2545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6402</th>\n",
       "      <td>851de3b4-8f0c-11eb-8cb8-000d3a38a36f</td>\n",
       "      <td>8.2857</td>\n",
       "      <td>9.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>862.5000</td>\n",
       "      <td>0.7939</td>\n",
       "      <td>1.5878</td>\n",
       "      <td>923.4758</td>\n",
       "      <td>1538.5158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6666</th>\n",
       "      <td>53fe00d4-7b7a-11eb-960b-000d3a38a36f</td>\n",
       "      <td>9.7143</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>17</td>\n",
       "      <td>259.8824</td>\n",
       "      <td>2.7807</td>\n",
       "      <td>5.5614</td>\n",
       "      <td>262.0901</td>\n",
       "      <td>1529.3281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19538</th>\n",
       "      <td>55d54d9e-8ac7-11ea-8ec0-000d3a38a36f</td>\n",
       "      <td>52.5714</td>\n",
       "      <td>58.7143</td>\n",
       "      <td>31</td>\n",
       "      <td>228.5161</td>\n",
       "      <td>3.0838</td>\n",
       "      <td>6.1676</td>\n",
       "      <td>229.5930</td>\n",
       "      <td>1485.7289</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14858</th>\n",
       "      <td>031b2954-6d28-11eb-99c4-000d3a38a36f</td>\n",
       "      <td>14.8571</td>\n",
       "      <td>15.5714</td>\n",
       "      <td>3</td>\n",
       "      <td>743.6667</td>\n",
       "      <td>0.8716</td>\n",
       "      <td>1.7431</td>\n",
       "      <td>778.1333</td>\n",
       "      <td>1423.1513</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg  exp_sales_3_month  exp_sales_6_month   exp_average_value      cltv\n",
       "9055   47a642fe-975b-11eb-8c2a-000d3a38a36f               2.8571    7.8571          4          1401.7500             1.0944              2.1888          1449.0079 3327.6564\n",
       "13880  7137a5c0-7aad-11ea-8f20-000d3a38a36f               6.1429   13.1429         11           758.0000             1.9701              3.9402           767.2740 3172.0363\n",
       "17323  f59053e2-a503-11e9-a2fc-000d3a38a36f              51.7143  101.0000          7          1106.4286             0.7222              1.4445          1127.5718 1708.9219\n",
       "12438  625f40a2-5bd2-11ea-98b0-000d3a38a36f              74.2857   74.5714         16           501.8750             1.5653              3.1306           506.1678 1662.6174\n",
       "8868   9ce6e520-89b0-11ea-a6e7-000d3a38a36f               3.4286   34.4286          8           601.2500             1.2655              2.5309           611.5166 1623.8763\n",
       "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f              62.7143   67.2857         52           164.6286             4.6561              9.3123           165.1123 1613.2545\n",
       "6402   851de3b4-8f0c-11eb-8cb8-000d3a38a36f               8.2857    9.4286          2           862.5000             0.7939              1.5878           923.4758 1538.5158\n",
       "6666   53fe00d4-7b7a-11eb-960b-000d3a38a36f               9.7143   13.0000         17           259.8824             2.7807              5.5614           262.0901 1529.3281\n",
       "19538  55d54d9e-8ac7-11ea-8ec0-000d3a38a36f              52.5714   58.7143         31           228.5161             3.0838              6.1676           229.5930 1485.7289\n",
       "14858  031b2954-6d28-11eb-99c4-000d3a38a36f              14.8571   15.5714          3           743.6667             0.8716              1.7431           778.1333 1423.1513"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Adım3:  6 aylık CLTV hesaplayınız ve cltv ismiyle dataframe'e ekleyiniz. Cltv değeri enyüksek 20 kişiyi gözlemleyiniz\n",
    "\n",
    "cltv_df[\"cltv\"] = ggf.customer_lifetime_value(bgf,\n",
    "                                   cltv_df['frequency'],\n",
    "                                   cltv_df['recency_cltv_weekly'],\n",
    "                                   cltv_df['T_weekly'],\n",
    "                                   cltv_df['monetary_cltv_avg'],\n",
    "                                   time=6,  # 6 aylık\n",
    "                                   freq=\"W\",  # T'nin frekans bilgisi.\n",
    "                                   discount_rate=0.01)\n",
    "\n",
    "cltv_df.sort_values(by=\"cltv\", ascending=False).head(10)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "6799b09e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:21.146588Z",
     "iopub.status.busy": "2024-09-10T19:13:21.146120Z",
     "iopub.status.idle": "2024-09-10T19:13:21.191607Z",
     "shell.execute_reply": "2024-09-10T19:13:21.189833Z"
    },
    "papermill": {
     "duration": 0.063367,
     "end_time": "2024-09-10T19:13:21.195181",
     "exception": false,
     "start_time": "2024-09-10T19:13:21.131814",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>recency_cltv_weekly</th>\n",
       "      <th>T_weekly</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary_cltv_avg</th>\n",
       "      <th>exp_sales_3_month</th>\n",
       "      <th>exp_sales_6_month</th>\n",
       "      <th>exp_average_value</th>\n",
       "      <th>cltv</th>\n",
       "      <th>segment</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9055</th>\n",
       "      <td>47a642fe-975b-11eb-8c2a-000d3a38a36f</td>\n",
       "      <td>2.8571</td>\n",
       "      <td>7.8571</td>\n",
       "      <td>4</td>\n",
       "      <td>1401.7500</td>\n",
       "      <td>1.0944</td>\n",
       "      <td>2.1888</td>\n",
       "      <td>1449.0079</td>\n",
       "      <td>3327.6564</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13880</th>\n",
       "      <td>7137a5c0-7aad-11ea-8f20-000d3a38a36f</td>\n",
       "      <td>6.1429</td>\n",
       "      <td>13.1429</td>\n",
       "      <td>11</td>\n",
       "      <td>758.0000</td>\n",
       "      <td>1.9701</td>\n",
       "      <td>3.9402</td>\n",
       "      <td>767.2740</td>\n",
       "      <td>3172.0363</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17323</th>\n",
       "      <td>f59053e2-a503-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>51.7143</td>\n",
       "      <td>101.0000</td>\n",
       "      <td>7</td>\n",
       "      <td>1106.4286</td>\n",
       "      <td>0.7222</td>\n",
       "      <td>1.4445</td>\n",
       "      <td>1127.5718</td>\n",
       "      <td>1708.9219</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12438</th>\n",
       "      <td>625f40a2-5bd2-11ea-98b0-000d3a38a36f</td>\n",
       "      <td>74.2857</td>\n",
       "      <td>74.5714</td>\n",
       "      <td>16</td>\n",
       "      <td>501.8750</td>\n",
       "      <td>1.5653</td>\n",
       "      <td>3.1306</td>\n",
       "      <td>506.1678</td>\n",
       "      <td>1662.6174</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8868</th>\n",
       "      <td>9ce6e520-89b0-11ea-a6e7-000d3a38a36f</td>\n",
       "      <td>3.4286</td>\n",
       "      <td>34.4286</td>\n",
       "      <td>8</td>\n",
       "      <td>601.2500</td>\n",
       "      <td>1.2655</td>\n",
       "      <td>2.5309</td>\n",
       "      <td>611.5166</td>\n",
       "      <td>1623.8763</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7330</th>\n",
       "      <td>a4d534a2-5b1b-11eb-8dbd-000d3a38a36f</td>\n",
       "      <td>62.7143</td>\n",
       "      <td>67.2857</td>\n",
       "      <td>52</td>\n",
       "      <td>164.6286</td>\n",
       "      <td>4.6561</td>\n",
       "      <td>9.3123</td>\n",
       "      <td>165.1123</td>\n",
       "      <td>1613.2545</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6402</th>\n",
       "      <td>851de3b4-8f0c-11eb-8cb8-000d3a38a36f</td>\n",
       "      <td>8.2857</td>\n",
       "      <td>9.4286</td>\n",
       "      <td>2</td>\n",
       "      <td>862.5000</td>\n",
       "      <td>0.7939</td>\n",
       "      <td>1.5878</td>\n",
       "      <td>923.4758</td>\n",
       "      <td>1538.5158</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6666</th>\n",
       "      <td>53fe00d4-7b7a-11eb-960b-000d3a38a36f</td>\n",
       "      <td>9.7143</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>17</td>\n",
       "      <td>259.8824</td>\n",
       "      <td>2.7807</td>\n",
       "      <td>5.5614</td>\n",
       "      <td>262.0901</td>\n",
       "      <td>1529.3281</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19538</th>\n",
       "      <td>55d54d9e-8ac7-11ea-8ec0-000d3a38a36f</td>\n",
       "      <td>52.5714</td>\n",
       "      <td>58.7143</td>\n",
       "      <td>31</td>\n",
       "      <td>228.5161</td>\n",
       "      <td>3.0838</td>\n",
       "      <td>6.1676</td>\n",
       "      <td>229.5930</td>\n",
       "      <td>1485.7289</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14858</th>\n",
       "      <td>031b2954-6d28-11eb-99c4-000d3a38a36f</td>\n",
       "      <td>14.8571</td>\n",
       "      <td>15.5714</td>\n",
       "      <td>3</td>\n",
       "      <td>743.6667</td>\n",
       "      <td>0.8716</td>\n",
       "      <td>1.7431</td>\n",
       "      <td>778.1333</td>\n",
       "      <td>1423.1513</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17963</th>\n",
       "      <td>8fd88976-6708-11ea-9d38-000d3a38a36f</td>\n",
       "      <td>50.2857</td>\n",
       "      <td>63.2857</td>\n",
       "      <td>7</td>\n",
       "      <td>694.1429</td>\n",
       "      <td>0.9176</td>\n",
       "      <td>1.8351</td>\n",
       "      <td>707.6286</td>\n",
       "      <td>1362.4975</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15516</th>\n",
       "      <td>9083981a-f59e-11e9-841e-000d3a38a36f</td>\n",
       "      <td>63.5714</td>\n",
       "      <td>83.8571</td>\n",
       "      <td>4</td>\n",
       "      <td>1090.2500</td>\n",
       "      <td>0.5746</td>\n",
       "      <td>1.1493</td>\n",
       "      <td>1127.2401</td>\n",
       "      <td>1359.3018</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6717</th>\n",
       "      <td>40b4f318-9dfb-11eb-9c47-000d3a38a36f</td>\n",
       "      <td>27.1429</td>\n",
       "      <td>33.8571</td>\n",
       "      <td>7</td>\n",
       "      <td>544.7143</td>\n",
       "      <td>1.1630</td>\n",
       "      <td>2.3259</td>\n",
       "      <td>555.4247</td>\n",
       "      <td>1355.4703</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4157</th>\n",
       "      <td>7eed6468-4540-11ea-acaf-000d3a38a36f</td>\n",
       "      <td>89.1429</td>\n",
       "      <td>90.0000</td>\n",
       "      <td>27</td>\n",
       "      <td>289.7778</td>\n",
       "      <td>2.2143</td>\n",
       "      <td>4.4287</td>\n",
       "      <td>291.3059</td>\n",
       "      <td>1353.5975</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4735</th>\n",
       "      <td>dbabb58e-6312-11ea-a6dc-000d3a38a36f</td>\n",
       "      <td>61.2857</td>\n",
       "      <td>64.2857</td>\n",
       "      <td>13</td>\n",
       "      <td>442.1538</td>\n",
       "      <td>1.4236</td>\n",
       "      <td>2.8473</td>\n",
       "      <td>446.8550</td>\n",
       "      <td>1334.9408</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11694</th>\n",
       "      <td>90f1b7f2-bbad-11ea-a0c9-000d3a38a36f</td>\n",
       "      <td>47.2857</td>\n",
       "      <td>48.0000</td>\n",
       "      <td>6</td>\n",
       "      <td>647.3333</td>\n",
       "      <td>0.9339</td>\n",
       "      <td>1.8677</td>\n",
       "      <td>662.0981</td>\n",
       "      <td>1297.4947</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11179</th>\n",
       "      <td>d2e74a36-3228-11eb-860c-000d3a38a36f</td>\n",
       "      <td>1.1429</td>\n",
       "      <td>26.2857</td>\n",
       "      <td>3</td>\n",
       "      <td>750.6667</td>\n",
       "      <td>0.7804</td>\n",
       "      <td>1.5608</td>\n",
       "      <td>785.4443</td>\n",
       "      <td>1286.3021</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1853</th>\n",
       "      <td>f02473b0-43c3-11eb-806e-000d3a38a36f</td>\n",
       "      <td>17.2857</td>\n",
       "      <td>23.1429</td>\n",
       "      <td>2</td>\n",
       "      <td>836.0000</td>\n",
       "      <td>0.6843</td>\n",
       "      <td>1.3686</td>\n",
       "      <td>895.1693</td>\n",
       "      <td>1285.4177</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5775</th>\n",
       "      <td>e31293ac-d63a-11e9-93bc-000d3a38a36f</td>\n",
       "      <td>91.7143</td>\n",
       "      <td>93.1429</td>\n",
       "      <td>8</td>\n",
       "      <td>727.1250</td>\n",
       "      <td>0.8266</td>\n",
       "      <td>1.6533</td>\n",
       "      <td>739.4325</td>\n",
       "      <td>1282.6437</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7312</th>\n",
       "      <td>90befc98-925a-11eb-b584-000d3a38a36f</td>\n",
       "      <td>4.1429</td>\n",
       "      <td>8.8571</td>\n",
       "      <td>6</td>\n",
       "      <td>431.3333</td>\n",
       "      <td>1.3638</td>\n",
       "      <td>2.7275</td>\n",
       "      <td>441.4031</td>\n",
       "      <td>1263.2053</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7936</th>\n",
       "      <td>ae4ce104-dbd4-11ea-8757-000d3a38a36f</td>\n",
       "      <td>3.7143</td>\n",
       "      <td>42.0000</td>\n",
       "      <td>3</td>\n",
       "      <td>844.3333</td>\n",
       "      <td>0.6766</td>\n",
       "      <td>1.3533</td>\n",
       "      <td>883.2734</td>\n",
       "      <td>1254.1601</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9738</th>\n",
       "      <td>3a27b334-dff4-11ea-acaa-000d3a38a36f</td>\n",
       "      <td>40.0000</td>\n",
       "      <td>41.1429</td>\n",
       "      <td>3</td>\n",
       "      <td>837.0000</td>\n",
       "      <td>0.6816</td>\n",
       "      <td>1.3632</td>\n",
       "      <td>875.6142</td>\n",
       "      <td>1252.3686</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7171</th>\n",
       "      <td>77e66e92-31fa-11eb-860c-000d3a38a36f</td>\n",
       "      <td>16.8571</td>\n",
       "      <td>26.2857</td>\n",
       "      <td>5</td>\n",
       "      <td>566.8000</td>\n",
       "      <td>1.0147</td>\n",
       "      <td>2.0293</td>\n",
       "      <td>582.4854</td>\n",
       "      <td>1240.2388</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10876</th>\n",
       "      <td>ae149d98-9b6a-11eb-9c47-000d3a38a36f</td>\n",
       "      <td>6.1429</td>\n",
       "      <td>7.1429</td>\n",
       "      <td>9</td>\n",
       "      <td>317.4444</td>\n",
       "      <td>1.8239</td>\n",
       "      <td>3.6478</td>\n",
       "      <td>322.4709</td>\n",
       "      <td>1234.2266</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2947</th>\n",
       "      <td>bdf7a804-b1dd-11e9-89fa-000d3a38a36f</td>\n",
       "      <td>90.5714</td>\n",
       "      <td>97.4286</td>\n",
       "      <td>18</td>\n",
       "      <td>380.2222</td>\n",
       "      <td>1.4975</td>\n",
       "      <td>2.9949</td>\n",
       "      <td>383.1659</td>\n",
       "      <td>1204.0374</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15611</th>\n",
       "      <td>4a7e875e-e6ce-11ea-8f44-000d3a38a36f</td>\n",
       "      <td>39.7143</td>\n",
       "      <td>40.0000</td>\n",
       "      <td>29</td>\n",
       "      <td>165.3103</td>\n",
       "      <td>3.3740</td>\n",
       "      <td>6.7479</td>\n",
       "      <td>166.1824</td>\n",
       "      <td>1176.5822</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1134</th>\n",
       "      <td>fdd08240-244a-11ea-a30f-000d3a38a36f</td>\n",
       "      <td>72.5714</td>\n",
       "      <td>78.5714</td>\n",
       "      <td>19</td>\n",
       "      <td>315.3684</td>\n",
       "      <td>1.7575</td>\n",
       "      <td>3.5150</td>\n",
       "      <td>317.7174</td>\n",
       "      <td>1171.7407</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18997</th>\n",
       "      <td>41231c72-566a-11eb-9e65-000d3a38a36f</td>\n",
       "      <td>2.5714</td>\n",
       "      <td>4.5714</td>\n",
       "      <td>7</td>\n",
       "      <td>344.0000</td>\n",
       "      <td>1.5848</td>\n",
       "      <td>3.1695</td>\n",
       "      <td>350.9825</td>\n",
       "      <td>1167.2135</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4016</th>\n",
       "      <td>b95511d4-aa3e-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>88.2857</td>\n",
       "      <td>94.4286</td>\n",
       "      <td>11</td>\n",
       "      <td>530.9091</td>\n",
       "      <td>1.0314</td>\n",
       "      <td>2.0628</td>\n",
       "      <td>537.5170</td>\n",
       "      <td>1163.3863</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2343</th>\n",
       "      <td>c430fc0e-27ce-11ea-aaaa-000d3a38a36f</td>\n",
       "      <td>88.8571</td>\n",
       "      <td>90.5714</td>\n",
       "      <td>26</td>\n",
       "      <td>257.1923</td>\n",
       "      <td>2.1348</td>\n",
       "      <td>4.2696</td>\n",
       "      <td>258.6188</td>\n",
       "      <td>1158.5372</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14330</th>\n",
       "      <td>90d628b6-1928-11ea-b6a2-000d3a38a36f</td>\n",
       "      <td>98.5714</td>\n",
       "      <td>117.4286</td>\n",
       "      <td>32</td>\n",
       "      <td>246.2500</td>\n",
       "      <td>2.2105</td>\n",
       "      <td>4.4211</td>\n",
       "      <td>247.3641</td>\n",
       "      <td>1147.4419</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16087</th>\n",
       "      <td>4031bc1e-c52a-11ea-9dde-000d3a38a36f</td>\n",
       "      <td>38.7143</td>\n",
       "      <td>46.4286</td>\n",
       "      <td>7</td>\n",
       "      <td>512.4286</td>\n",
       "      <td>1.0437</td>\n",
       "      <td>2.0874</td>\n",
       "      <td>522.5393</td>\n",
       "      <td>1144.4562</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15552</th>\n",
       "      <td>7e10b500-5b0b-11ea-9b03-000d3a38a36f</td>\n",
       "      <td>52.7143</td>\n",
       "      <td>66.0000</td>\n",
       "      <td>10</td>\n",
       "      <td>465.1000</td>\n",
       "      <td>1.1533</td>\n",
       "      <td>2.3065</td>\n",
       "      <td>471.5264</td>\n",
       "      <td>1141.1114</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18767</th>\n",
       "      <td>fc0ce7a4-9d87-11e9-9897-000d3a38a36f</td>\n",
       "      <td>102.5714</td>\n",
       "      <td>131.4286</td>\n",
       "      <td>20</td>\n",
       "      <td>393.2500</td>\n",
       "      <td>1.3678</td>\n",
       "      <td>2.7356</td>\n",
       "      <td>395.9811</td>\n",
       "      <td>1136.5823</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6857</th>\n",
       "      <td>0515a7ec-d49f-11ea-9838-000d3a38a36f</td>\n",
       "      <td>41.1429</td>\n",
       "      <td>43.2857</td>\n",
       "      <td>16</td>\n",
       "      <td>256.8750</td>\n",
       "      <td>1.9753</td>\n",
       "      <td>3.9505</td>\n",
       "      <td>259.1976</td>\n",
       "      <td>1074.3670</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1775</th>\n",
       "      <td>020e2b84-5bbb-11eb-8dbd-000d3a38a36f</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>18.7143</td>\n",
       "      <td>5</td>\n",
       "      <td>443.0000</td>\n",
       "      <td>1.0956</td>\n",
       "      <td>2.1913</td>\n",
       "      <td>455.4422</td>\n",
       "      <td>1047.1156</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10536</th>\n",
       "      <td>e143b6fa-d6f8-11e9-93bc-000d3a38a36f</td>\n",
       "      <td>104.5714</td>\n",
       "      <td>113.4286</td>\n",
       "      <td>40</td>\n",
       "      <td>176.2000</td>\n",
       "      <td>2.7635</td>\n",
       "      <td>5.5270</td>\n",
       "      <td>176.8663</td>\n",
       "      <td>1025.6543</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6484</th>\n",
       "      <td>ec547c8c-bd11-11ea-aa61-000d3a38a36f</td>\n",
       "      <td>43.0000</td>\n",
       "      <td>47.5714</td>\n",
       "      <td>13</td>\n",
       "      <td>299.1538</td>\n",
       "      <td>1.6159</td>\n",
       "      <td>3.2318</td>\n",
       "      <td>302.4370</td>\n",
       "      <td>1025.5424</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6987</th>\n",
       "      <td>965a6964-98f3-11ea-b97a-000d3a38a36f</td>\n",
       "      <td>15.7143</td>\n",
       "      <td>54.2857</td>\n",
       "      <td>3</td>\n",
       "      <td>752.0000</td>\n",
       "      <td>0.6129</td>\n",
       "      <td>1.2258</td>\n",
       "      <td>786.8369</td>\n",
       "      <td>1012.0163</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11003</th>\n",
       "      <td>388eabac-7840-11ea-bfad-000d3a38a36f</td>\n",
       "      <td>59.5714</td>\n",
       "      <td>60.1429</td>\n",
       "      <td>4</td>\n",
       "      <td>688.7500</td>\n",
       "      <td>0.6746</td>\n",
       "      <td>1.3492</td>\n",
       "      <td>712.5057</td>\n",
       "      <td>1008.6571</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6756</th>\n",
       "      <td>27310582-6362-11ea-a6dc-000d3a38a36f</td>\n",
       "      <td>62.7143</td>\n",
       "      <td>64.1429</td>\n",
       "      <td>29</td>\n",
       "      <td>168.8966</td>\n",
       "      <td>2.7934</td>\n",
       "      <td>5.5869</td>\n",
       "      <td>169.7844</td>\n",
       "      <td>995.2524</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8662</th>\n",
       "      <td>de359bb8-294b-11ea-b87a-000d3a38a36f</td>\n",
       "      <td>76.5714</td>\n",
       "      <td>81.1429</td>\n",
       "      <td>13</td>\n",
       "      <td>367.0000</td>\n",
       "      <td>1.2711</td>\n",
       "      <td>2.5422</td>\n",
       "      <td>370.9559</td>\n",
       "      <td>989.4496</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9432</th>\n",
       "      <td>927b7822-9b25-11ea-a27a-000d3a38a36f</td>\n",
       "      <td>36.8571</td>\n",
       "      <td>49.2857</td>\n",
       "      <td>17</td>\n",
       "      <td>236.5294</td>\n",
       "      <td>1.9764</td>\n",
       "      <td>3.9529</td>\n",
       "      <td>238.5604</td>\n",
       "      <td>989.4189</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10489</th>\n",
       "      <td>7af5cd16-b100-11e9-9757-000d3a38a36f</td>\n",
       "      <td>103.1429</td>\n",
       "      <td>111.8571</td>\n",
       "      <td>43</td>\n",
       "      <td>157.1163</td>\n",
       "      <td>2.9780</td>\n",
       "      <td>5.9561</td>\n",
       "      <td>157.6792</td>\n",
       "      <td>985.3793</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3646</th>\n",
       "      <td>2da98f66-b150-11e9-9757-000d3a38a36f</td>\n",
       "      <td>110.2857</td>\n",
       "      <td>112.4286</td>\n",
       "      <td>33</td>\n",
       "      <td>197.5455</td>\n",
       "      <td>2.3328</td>\n",
       "      <td>4.6655</td>\n",
       "      <td>198.4365</td>\n",
       "      <td>971.3803</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9737</th>\n",
       "      <td>eca73abc-1e29-11ea-8bf2-000d3a38a36f</td>\n",
       "      <td>46.4286</td>\n",
       "      <td>91.0000</td>\n",
       "      <td>5</td>\n",
       "      <td>723.2000</td>\n",
       "      <td>0.6219</td>\n",
       "      <td>1.2438</td>\n",
       "      <td>742.9826</td>\n",
       "      <td>969.5733</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15123</th>\n",
       "      <td>635b5e0a-a686-11eb-a6d3-000d3a299ebf</td>\n",
       "      <td>2.0000</td>\n",
       "      <td>5.1429</td>\n",
       "      <td>3</td>\n",
       "      <td>447.0000</td>\n",
       "      <td>0.9833</td>\n",
       "      <td>1.9667</td>\n",
       "      <td>468.2833</td>\n",
       "      <td>966.2969</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10628</th>\n",
       "      <td>c7686de8-41ba-11ea-96d9-000d3a38a36f</td>\n",
       "      <td>68.1429</td>\n",
       "      <td>79.7143</td>\n",
       "      <td>8</td>\n",
       "      <td>501.7500</td>\n",
       "      <td>0.8978</td>\n",
       "      <td>1.7957</td>\n",
       "      <td>510.4033</td>\n",
       "      <td>961.6301</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10578</th>\n",
       "      <td>efd2ccf8-9fab-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>77.4286</td>\n",
       "      <td>81.2857</td>\n",
       "      <td>16</td>\n",
       "      <td>301.3750</td>\n",
       "      <td>1.4986</td>\n",
       "      <td>2.9971</td>\n",
       "      <td>304.0555</td>\n",
       "      <td>956.1479</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4315</th>\n",
       "      <td>d5ef8058-a5c6-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>133.1429</td>\n",
       "      <td>147.1429</td>\n",
       "      <td>49</td>\n",
       "      <td>160.2020</td>\n",
       "      <td>2.8299</td>\n",
       "      <td>5.6598</td>\n",
       "      <td>160.7039</td>\n",
       "      <td>954.3236</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                customer_id  recency_cltv_weekly  T_weekly  frequency  monetary_cltv_avg  exp_sales_3_month  exp_sales_6_month   exp_average_value      cltv segment\n",
       "9055   47a642fe-975b-11eb-8c2a-000d3a38a36f               2.8571    7.8571          4          1401.7500             1.0944              2.1888          1449.0079 3327.6564       A\n",
       "13880  7137a5c0-7aad-11ea-8f20-000d3a38a36f               6.1429   13.1429         11           758.0000             1.9701              3.9402           767.2740 3172.0363       A\n",
       "17323  f59053e2-a503-11e9-a2fc-000d3a38a36f              51.7143  101.0000          7          1106.4286             0.7222              1.4445          1127.5718 1708.9219       A\n",
       "12438  625f40a2-5bd2-11ea-98b0-000d3a38a36f              74.2857   74.5714         16           501.8750             1.5653              3.1306           506.1678 1662.6174       A\n",
       "8868   9ce6e520-89b0-11ea-a6e7-000d3a38a36f               3.4286   34.4286          8           601.2500             1.2655              2.5309           611.5166 1623.8763       A\n",
       "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f              62.7143   67.2857         52           164.6286             4.6561              9.3123           165.1123 1613.2545       A\n",
       "6402   851de3b4-8f0c-11eb-8cb8-000d3a38a36f               8.2857    9.4286          2           862.5000             0.7939              1.5878           923.4758 1538.5158       A\n",
       "6666   53fe00d4-7b7a-11eb-960b-000d3a38a36f               9.7143   13.0000         17           259.8824             2.7807              5.5614           262.0901 1529.3281       A\n",
       "19538  55d54d9e-8ac7-11ea-8ec0-000d3a38a36f              52.5714   58.7143         31           228.5161             3.0838              6.1676           229.5930 1485.7289       A\n",
       "14858  031b2954-6d28-11eb-99c4-000d3a38a36f              14.8571   15.5714          3           743.6667             0.8716              1.7431           778.1333 1423.1513       A\n",
       "17963  8fd88976-6708-11ea-9d38-000d3a38a36f              50.2857   63.2857          7           694.1429             0.9176              1.8351           707.6286 1362.4975       A\n",
       "15516  9083981a-f59e-11e9-841e-000d3a38a36f              63.5714   83.8571          4          1090.2500             0.5746              1.1493          1127.2401 1359.3018       A\n",
       "6717   40b4f318-9dfb-11eb-9c47-000d3a38a36f              27.1429   33.8571          7           544.7143             1.1630              2.3259           555.4247 1355.4703       A\n",
       "4157   7eed6468-4540-11ea-acaf-000d3a38a36f              89.1429   90.0000         27           289.7778             2.2143              4.4287           291.3059 1353.5975       A\n",
       "4735   dbabb58e-6312-11ea-a6dc-000d3a38a36f              61.2857   64.2857         13           442.1538             1.4236              2.8473           446.8550 1334.9408       A\n",
       "11694  90f1b7f2-bbad-11ea-a0c9-000d3a38a36f              47.2857   48.0000          6           647.3333             0.9339              1.8677           662.0981 1297.4947       A\n",
       "11179  d2e74a36-3228-11eb-860c-000d3a38a36f               1.1429   26.2857          3           750.6667             0.7804              1.5608           785.4443 1286.3021       A\n",
       "1853   f02473b0-43c3-11eb-806e-000d3a38a36f              17.2857   23.1429          2           836.0000             0.6843              1.3686           895.1693 1285.4177       A\n",
       "5775   e31293ac-d63a-11e9-93bc-000d3a38a36f              91.7143   93.1429          8           727.1250             0.8266              1.6533           739.4325 1282.6437       A\n",
       "7312   90befc98-925a-11eb-b584-000d3a38a36f               4.1429    8.8571          6           431.3333             1.3638              2.7275           441.4031 1263.2053       A\n",
       "7936   ae4ce104-dbd4-11ea-8757-000d3a38a36f               3.7143   42.0000          3           844.3333             0.6766              1.3533           883.2734 1254.1601       A\n",
       "9738   3a27b334-dff4-11ea-acaa-000d3a38a36f              40.0000   41.1429          3           837.0000             0.6816              1.3632           875.6142 1252.3686       A\n",
       "7171   77e66e92-31fa-11eb-860c-000d3a38a36f              16.8571   26.2857          5           566.8000             1.0147              2.0293           582.4854 1240.2388       A\n",
       "10876  ae149d98-9b6a-11eb-9c47-000d3a38a36f               6.1429    7.1429          9           317.4444             1.8239              3.6478           322.4709 1234.2266       A\n",
       "2947   bdf7a804-b1dd-11e9-89fa-000d3a38a36f              90.5714   97.4286         18           380.2222             1.4975              2.9949           383.1659 1204.0374       A\n",
       "15611  4a7e875e-e6ce-11ea-8f44-000d3a38a36f              39.7143   40.0000         29           165.3103             3.3740              6.7479           166.1824 1176.5822       A\n",
       "1134   fdd08240-244a-11ea-a30f-000d3a38a36f              72.5714   78.5714         19           315.3684             1.7575              3.5150           317.7174 1171.7407       A\n",
       "18997  41231c72-566a-11eb-9e65-000d3a38a36f               2.5714    4.5714          7           344.0000             1.5848              3.1695           350.9825 1167.2135       A\n",
       "4016   b95511d4-aa3e-11e9-a2fc-000d3a38a36f              88.2857   94.4286         11           530.9091             1.0314              2.0628           537.5170 1163.3863       A\n",
       "2343   c430fc0e-27ce-11ea-aaaa-000d3a38a36f              88.8571   90.5714         26           257.1923             2.1348              4.2696           258.6188 1158.5372       A\n",
       "14330  90d628b6-1928-11ea-b6a2-000d3a38a36f              98.5714  117.4286         32           246.2500             2.2105              4.4211           247.3641 1147.4419       A\n",
       "16087  4031bc1e-c52a-11ea-9dde-000d3a38a36f              38.7143   46.4286          7           512.4286             1.0437              2.0874           522.5393 1144.4562       A\n",
       "15552  7e10b500-5b0b-11ea-9b03-000d3a38a36f              52.7143   66.0000         10           465.1000             1.1533              2.3065           471.5264 1141.1114       A\n",
       "18767  fc0ce7a4-9d87-11e9-9897-000d3a38a36f             102.5714  131.4286         20           393.2500             1.3678              2.7356           395.9811 1136.5823       A\n",
       "6857   0515a7ec-d49f-11ea-9838-000d3a38a36f              41.1429   43.2857         16           256.8750             1.9753              3.9505           259.1976 1074.3670       A\n",
       "1775   020e2b84-5bbb-11eb-8dbd-000d3a38a36f               1.0000   18.7143          5           443.0000             1.0956              2.1913           455.4422 1047.1156       A\n",
       "10536  e143b6fa-d6f8-11e9-93bc-000d3a38a36f             104.5714  113.4286         40           176.2000             2.7635              5.5270           176.8663 1025.6543       A\n",
       "6484   ec547c8c-bd11-11ea-aa61-000d3a38a36f              43.0000   47.5714         13           299.1538             1.6159              3.2318           302.4370 1025.5424       A\n",
       "6987   965a6964-98f3-11ea-b97a-000d3a38a36f              15.7143   54.2857          3           752.0000             0.6129              1.2258           786.8369 1012.0163       A\n",
       "11003  388eabac-7840-11ea-bfad-000d3a38a36f              59.5714   60.1429          4           688.7500             0.6746              1.3492           712.5057 1008.6571       A\n",
       "6756   27310582-6362-11ea-a6dc-000d3a38a36f              62.7143   64.1429         29           168.8966             2.7934              5.5869           169.7844  995.2524       A\n",
       "8662   de359bb8-294b-11ea-b87a-000d3a38a36f              76.5714   81.1429         13           367.0000             1.2711              2.5422           370.9559  989.4496       A\n",
       "9432   927b7822-9b25-11ea-a27a-000d3a38a36f              36.8571   49.2857         17           236.5294             1.9764              3.9529           238.5604  989.4189       A\n",
       "10489  7af5cd16-b100-11e9-9757-000d3a38a36f             103.1429  111.8571         43           157.1163             2.9780              5.9561           157.6792  985.3793       A\n",
       "3646   2da98f66-b150-11e9-9757-000d3a38a36f             110.2857  112.4286         33           197.5455             2.3328              4.6655           198.4365  971.3803       A\n",
       "9737   eca73abc-1e29-11ea-8bf2-000d3a38a36f              46.4286   91.0000          5           723.2000             0.6219              1.2438           742.9826  969.5733       A\n",
       "15123  635b5e0a-a686-11eb-a6d3-000d3a299ebf               2.0000    5.1429          3           447.0000             0.9833              1.9667           468.2833  966.2969       A\n",
       "10628  c7686de8-41ba-11ea-96d9-000d3a38a36f              68.1429   79.7143          8           501.7500             0.8978              1.7957           510.4033  961.6301       A\n",
       "10578  efd2ccf8-9fab-11e9-a2fc-000d3a38a36f              77.4286   81.2857         16           301.3750             1.4986              2.9971           304.0555  956.1479       A\n",
       "4315   d5ef8058-a5c6-11e9-a2fc-000d3a38a36f             133.1429  147.1429         49           160.2020             2.8299              5.6598           160.7039  954.3236       A"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Görev 4:  CLTV Değerine Göre Segmentlerin Oluşturulması\n",
    "cltv_df[\"segment\"] = pd.qcut(cltv_df[\"cltv\"], 4, labels=[\"D\", \"C\", \"B\", \"A\"])\n",
    "cltv_df.sort_values(by=\"cltv\", ascending=False).head(50)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "3c66d2a7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T19:13:21.222582Z",
     "iopub.status.busy": "2024-09-10T19:13:21.222140Z",
     "iopub.status.idle": "2024-09-10T19:13:21.254692Z",
     "shell.execute_reply": "2024-09-10T19:13:21.253156Z"
    },
    "papermill": {
     "duration": 0.049701,
     "end_time": "2024-09-10T19:13:21.257610",
     "exception": false,
     "start_time": "2024-09-10T19:13:21.207909",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"3\" halign=\"left\">recency_cltv_weekly</th>\n",
       "      <th colspan=\"3\" halign=\"left\">monetary_cltv_avg</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>sum</th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>sum</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>segment</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>D</th>\n",
       "      <td>4987</td>\n",
       "      <td>139.0012</td>\n",
       "      <td>693199.0000</td>\n",
       "      <td>4987</td>\n",
       "      <td>93.1420</td>\n",
       "      <td>464499.3415</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>C</th>\n",
       "      <td>4986</td>\n",
       "      <td>92.5992</td>\n",
       "      <td>461699.4286</td>\n",
       "      <td>4986</td>\n",
       "      <td>125.7862</td>\n",
       "      <td>627169.9361</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>B</th>\n",
       "      <td>4986</td>\n",
       "      <td>82.0119</td>\n",
       "      <td>408911.4286</td>\n",
       "      <td>4986</td>\n",
       "      <td>160.6199</td>\n",
       "      <td>800850.7365</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A</th>\n",
       "      <td>4986</td>\n",
       "      <td>67.4329</td>\n",
       "      <td>336220.5714</td>\n",
       "      <td>4986</td>\n",
       "      <td>228.8332</td>\n",
       "      <td>1140962.2285</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        recency_cltv_weekly                      monetary_cltv_avg                      \n",
       "                      count     mean         sum             count     mean          sum\n",
       "segment                                                                                 \n",
       "D                      4987 139.0012 693199.0000              4987  93.1420  464499.3415\n",
       "C                      4986  92.5992 461699.4286              4986 125.7862  627169.9361\n",
       "B                      4986  82.0119 408911.4286              4986 160.6199  800850.7365\n",
       "A                      4986  67.4329 336220.5714              4986 228.8332 1140962.2285"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Adım2:  4 grupiçerisinden seçeceğiniz 2 grup için yönetime kısa kısa 6 aylık aksiyon önerilerinde bulununuz\n",
    "cltv_df.groupby(\"segment\").agg({\"recency_cltv_weekly\":[\"count\", \"mean\", \"sum\"],\"monetary_cltv_avg\":[\"count\", \"mean\", \"sum\"]})\n",
    "\n",
    "#C segmenti için=>recency geliştirmelerin yöntemleri denenebilir. örn:kişisel kampanyalar çıkmak(geçmişte aldığı ürün kategorileri, harcama tutarlarını tutuyor olabiliriz.) favori kampanya türleri çıkartabilir.\n",
    "#örneğin ürün 50 tl ise ve C segmentinin ortalama harcaması 45 tl ise 10tl'lik indirim kampanyası uygulanabilir.\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5659730,
     "sourceId": 9339367,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30761,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 34.263845,
   "end_time": "2024-09-10T19:13:21.994773",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-09-10T19:12:47.730928",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
